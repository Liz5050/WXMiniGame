{"version":3,"sources":["file:///G:/Work/cocoscreator/MiniGame/assets/script/common/TweenManager.ts"],"names":["GTween","TweenManager","UITransform","error","game","constructor","_target","_targetName","_targetTransform","_targetPos","_targetScale","_targetRotation","_isTargetSelf","_targetProps","_steps","_initialProps","_stepProps","_isStart","_stepTime","_curStep","_lastStep","_loop","_loopCount","_loopTotalCount","_loopComplete","_stepIdx","_onChange","_onChangeObj","_tweenId","resetTime","timeIndex","setProps","props","loopTotalCount","loop","onChange","onChangeObj","setTarget","t","tweenId","getTarget","to","duration","ease","key","getTargetAttr","clearTargetByKey","addStep","type","call","callback","thisObj","params","callBack","wait","time","step","push","beginTween","getStep","length","apply","stopAction","setTargetAttr","shift","totalTime","console","log","runAction","self","setInterval","curTime","ratio","Math","min","keyName","undefined","diff","value","checkTargetAttr","k","errorTips","ccIdx","__classname__","indexOf","getComponent","getPosition","getScale","getRotation","curStepStr","getStepTestStr","stepStr","i","targetName","RemoveTweenById","v","setPosition","GetTweenAttrName","setScale","setRotation","reset","clearInterval","clearTarget","getTween","tw","TweenPool","pool","addTween","target","TweenId","TweenList","TweenTargets","TweenCount","removeTweens","id","Number","attrName","TweenAttrMap","scaleX","scaleY","scaleZ","rotationX","rotationY","rotationZ","width","height"],"mappings":"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","sourcesContent":["import { Component, Director, UITransform, _decorator, director, error, game, math } from \"cc\";\r\n\r\n/**\r\n * 对象池管理缓动\r\n * @author Liz 2019年4月18日21:10:57\r\n */\r\nclass GTween {\r\n\tprivate _target:any;\r\n    private _targetName:string;\r\n    private _targetTransform:UITransform;\r\n    private _targetPos:math.Vec3;\r\n    private _targetScale:math.Vec3;\r\n    private _targetRotation:math.Vec3;\r\n    private _isTargetSelf:boolean;\r\n    private _targetProps:any;\r\n\r\n\tprivate _steps:any[];\r\n\tprivate _initialProps:any;\r\n\tprivate _stepProps:any;\r\n\tprivate _isStart:boolean = false;\r\n\tprivate _stepTime:number;\r\n\tprivate _curStep:any;\r\n\tprivate _lastStep:any;\r\n\r\n\tprivate _loop:boolean = false;\r\n    private _loopCount:number = 0;\r\n    private _loopTotalCount:number = 0;\r\n    private _loopComplete:Function;\r\n\tprivate _stepIdx:number = 0;\r\n\tprivate _onChange:Function;\r\n\tprivate _onChangeObj:any;\r\n    private _tweenId:number = 0;\r\n    public resetTime:number = 0;\r\n\tpublic constructor() {\r\n\t}\r\n\r\n\tpublic setProps(props:any):void {\r\n\t\tif(!props) return;\r\n        this._loopTotalCount = props.loopTotalCount;\r\n        if(props.loop || (this._loopTotalCount && this._loopTotalCount > 0)){\r\n            this._loop = true;\r\n        }\r\n\t\tthis._onChange = props.onChange;\r\n\t\tthis._onChangeObj = props.onChangeObj;\r\n        this._loopComplete = props._loopComplete;\r\n\t}\r\n\r\n\tpublic setTarget(t:any,tweenId:number) {\r\n\t\tthis._target = t;\r\n        this._tweenId = tweenId;\r\n\t\tthis._initialProps = null;\r\n\t}\r\n\r\n    public get tweenId():number {\r\n        return this._tweenId;\r\n    }\r\n\r\n\tpublic getTarget():any {\r\n\t\treturn this._target;\r\n\t}\r\n\r\n\tpublic to(props:any,duration?:number,ease?: Function):GTween {\r\n\t\tif(!this._target) return;\r\n\t\tif(!props || typeof(props) != \"object\") return;\r\n\t\tif(!duration || duration < 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n        if(!this._initialProps){\r\n            this._initialProps = {}\r\n            for(let key in props) {\r\n                this._initialProps[key] = this.getTargetAttr(key);\r\n                this.clearTargetByKey(key);\r\n            }\r\n        }\r\n\t\tthis.addStep({\r\n\t\t\ttype:\"to\",\r\n\t\t\tprops:props,\r\n\t\t\tduration:duration,\r\n\t\t\tease:ease});\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic call(callback: Function, thisObj?: any, params?: any[]):GTween {\r\n\t\tthis.addStep({\r\n\t\t\ttype : \"call\",\r\n\t\t\tcallBack : callback,\r\n\t\t\tthisObj : thisObj,\r\n\t\t\tparams : params});\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic wait(time:number):GTween {\r\n\t\tthis.addStep({\r\n\t\t\ttype : \"wait\",\r\n\t\t\tduration : time});\r\n\t\treturn this;\r\n\t}\r\n\r\n\tprivate addStep(step:any):void {\r\n\t\tif(!this._steps) {\r\n\t\t\tthis._steps = [];\r\n\t\t}\r\n\t\tthis._steps.push(step);\r\n\t\tthis.beginTween();\r\n\t}\r\n\t\r\n\tprivate beginTween():void {\r\n\t\tif(this._isStart) return;\r\n\t\tthis._isStart = true;\r\n\t\tthis.getStep();\r\n\t}\r\n\r\n\tprivate getStep():void {\r\n\t\tif(!this._isStart) return;\r\n\t\tif(this._loop) {\r\n\t\t\tif(this._stepIdx >= this._steps.length) {\r\n                this._loopCount ++;\r\n                if(this._loopTotalCount && this._loopTotalCount > 0 && this._loopCount >= this._loopTotalCount){\r\n                    //loopComplete\r\n                    if(this._loopComplete){\r\n                        this._loopComplete.apply(this._curStep.thisObj);\r\n                        // this._loopComplete.call();\r\n                    }\r\n                    this.stopAction();\r\n                    return\r\n                }\r\n\t\t\t\tthis._stepIdx = 0;\r\n                if(this._initialProps){\r\n                    for(let key in this._initialProps) {\r\n                        this.setTargetAttr(key,this._initialProps[key]);\r\n                        // this._target[key] = this._initialProps[key];\r\n                    }\r\n                }\r\n                //一轮循环结束，属性已经重设到初始值，不用校正\r\n                this._lastStep = null;\r\n\t\t\t}\r\n\t\t\tthis._curStep = this._steps[this._stepIdx];\r\n\t\t\tthis._stepIdx ++;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis._curStep = this._steps.shift();\r\n\t\t}\r\n\t\t//属性校正\r\n\t\tif(this._lastStep && this._lastStep.props) {\r\n\t\t\tfor(let key in this._lastStep.props) {\r\n\t\t\t\tthis._target[key] = this._lastStep.props[key];\r\n                this.setTargetAttr(key,this._lastStep.props[key]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._lastStep = this._curStep;\r\n\t\tif(!this._curStep) {\r\n\t\t\tthis.stopAction();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(this._curStep.type == \"call\") {\r\n\t\t\tthis._curStep.callBack.apply(this._curStep.thisObj,this._curStep.params);\r\n\t\t\tthis.getStep();\r\n\t\t\treturn;\r\n        }\r\n\t\tthis._stepTime = game.totalTime + this._curStep.duration;\r\n        console.log(\"缓动时间戳：\" + this._stepTime)\r\n\t\tthis._stepProps = {};\r\n\t\tthis.runAction();\r\n\t}\r\n\r\n\tprivate timeIndex:number = -1;\r\n\tprivate runAction():void {\r\n\t\tif(this.timeIndex == -1) {\r\n            let self = this;\r\n\t\t\tthis.timeIndex = setInterval(function(){\r\n\t\t\t\tlet curTime:number = game.totalTime;\r\n                console.log(\"当前时间戳：\" + curTime)\r\n\t\t\t\tif(curTime >= self._stepTime){\r\n\t\t\t\t\tself.getStep();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif(self._curStep.type == \"to\") {\r\n\t\t\t\t\tlet props:any = self._curStep.props;\r\n\t\t\t\t\tlet ratio:number = (self._curStep.duration - (self._stepTime - curTime)) / self._curStep.duration;\r\n\t\t\t\t\tratio = Math.min(ratio,1);\r\n\t\t\t\t\tif(self._curStep.ease) {\r\n\t\t\t\t\t\tratio = self._curStep.ease(ratio,0,1,1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(let keyName in props) {\r\n\t\t\t\t\t\tif(self._stepProps[keyName] == undefined) {\r\n\t\t\t\t\t\t\tself._stepProps[keyName] = self.getTargetAttr(keyName);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlet diff:number = props[keyName] - self._stepProps[keyName];\r\n                        let value = self._stepProps[keyName] + (diff * ratio);\r\n                        self._targetProps[keyName] = value;\r\n                        self.setTargetAttr(keyName,value);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(self._onChange && self._onChangeObj) {\r\n\t\t\t\t\tself._onChange.apply(self._onChangeObj,self._targetProps);\r\n\t\t\t\t}\r\n\t\t\t},1);\r\n\t\t}\r\n\t}\r\n\r\n    private checkTargetAttr(k:string){\r\n        let errorTips = \"\";\r\n        let ccIdx:number = this._target.__classname__.indexOf(\"cc.\");\r\n        if (typeof(this._target) == \"object\" && ccIdx == -1){\r\n            if(this._target[k]){\r\n                this._isTargetSelf = true\r\n            }\r\n            else{\r\n                errorTips = \"not found \" + k + \" in tween target.\";\r\n            }\r\n        }else{\r\n            if(this._target == null){\r\n                errorTips = \"tween target is null\";\r\n            }\r\n            else{\r\n                if(!this._targetTransform){\r\n                    this._targetTransform = this._target.getComponent(UITransform);\r\n                }\r\n                if(!this._targetTransform){\r\n                    errorTips = \"not found transform in tween target. ----key：\" + k;\r\n                }\r\n            }\r\n        }\r\n\r\n        if(errorTips == \"\"){\r\n            if(k == \"x\" || k == \"y\" || k == \"z\"){\r\n                if(!this._targetPos){\r\n                    this._targetPos = this._target.getPosition();\r\n                }\r\n            }\r\n            else if(k == \"scaleX\" || k == \"scaleY\" || k == \"scaleZ\"){\r\n                if(!this._targetScale){\r\n                    this._targetScale = this._target.getScale();\r\n                }\r\n            }\r\n            else if(k == \"rotationX\" || k == \"rotationY\" || k == \"rotationZ\"){\r\n                if(!this._targetRotation){\r\n                    this._targetRotation = this._target.getRotation();\r\n                }\r\n            }\r\n            else if(k == \"width\" || k == \"height\"){\r\n               \r\n            }\r\n            else if(!this._target[k]){\r\n                errorTips = \"not found \" + k + \" in tween target.\";\r\n            }\r\n        }\r\n        if(errorTips != \"\"){\r\n            let curStepStr:string = this.getStepTestStr(this._curStep);\r\n            let stepStr:string = \"\";\r\n            if(this._steps){\r\n                for(let i:number = 0; i < this._steps.length; i ++){\r\n                    stepStr = stepStr + \"(step\" + i + \")\" + this.getStepTestStr(this._steps[i]);\r\n                }\r\n            }\r\n            let targetName = this._targetName;\r\n            TweenManager.RemoveTweenById(this._tweenId);\r\n            error(errorTips + \"--->>>targetName：\" + targetName + \"，curStep：\" + curStepStr + \"，stepList：\" + stepStr);\r\n        }\r\n    }\r\n\r\n    private getStepTestStr(step:any):string{\r\n        let stepStr:string = \"\";\r\n        if(step){\r\n            stepStr = step.type\r\n            if(step.props){\r\n                for (let key in step.props) {\r\n                    let v = step.props[key];\r\n                    stepStr = stepStr + \"-->\" + key + \"=\" + v + \",\";\r\n                }\r\n            }\r\n            if(step.duration){\r\n                stepStr = stepStr + \"time：\" + step.duration;\r\n            }\r\n        }\r\n        return stepStr;\r\n    }\r\n\r\n    private setTargetAttr(k: string,v: any){\r\n        this.checkTargetAttr(k);\r\n        if(this._isTargetSelf){\r\n            this._target[k] = v;\r\n            return;\r\n        }\r\n        if(k == \"x\" || k == \"y\" || k == \"z\"){\r\n            this._targetPos[k] = v;\r\n            this._target.setPosition(this._targetPos);\r\n        }\r\n        else if(k == \"scaleX\" || k == \"scaleY\" || k == \"scaleZ\"){\r\n            this._targetScale[TweenManager.GetTweenAttrName(k)] = v;\r\n            this._target.setScale(this._targetScale);\r\n        }\r\n        else if(k == \"rotationX\" || k == \"rotationY\" || k == \"rotationZ\"){\r\n            this._targetRotation[TweenManager.GetTweenAttrName(k)] = v;\r\n            this._target.setRotation(this._targetRotation);\r\n        }\r\n        else if(k == \"width\" || k == \"height\"){\r\n            this._targetTransform[k] = v;\r\n        }\r\n        else if(this._target[k]){\r\n            this._target[k] = v;\r\n        }\r\n    }\r\n\r\n    private getTargetAttr(k){\r\n        this.checkTargetAttr(k);\r\n        if(this._isTargetSelf){\r\n            return this._target[k];\r\n        }\r\n        if(k == \"x\" || k == \"y\" || k == \"z\"){\r\n            return this._targetPos[k];\r\n        }\r\n        else if(k == \"scaleX\" || k == \"scaleY\" || k == \"scaleZ\"){\r\n            return this._targetScale[TweenManager.GetTweenAttrName(k)];\r\n        }\r\n        else if(k == \"rotationX\" || k == \"rotationY\" || k == \"rotationZ\"){\r\n            return this._targetRotation[TweenManager.GetTweenAttrName(k)];\r\n        }\r\n        else{\r\n            return this._target[k];\r\n        }\r\n    }\r\n\r\n\tprivate stopAction():void {\r\n        // if not self.isStart or self.tweenId == 0 then return end\r\n\t\t//     TweenUtil.RemoveTween(self.tweenId)\r\n\t\tif(!this._isStart || this._tweenId == 0) return;\r\n\t\tTweenManager.RemoveTweenById(this._tweenId);\r\n\t}\r\n\r\n\tpublic reset():void {\r\n\t\tif(!this._isStart) return;\r\n\t\tif(this.timeIndex != -1) {\r\n            clearInterval(this.timeIndex);\r\n\t\t\tthis.timeIndex = -1;\r\n\t\t}\r\n\t\tthis._stepIdx = 0;\r\n\t\tthis._loop = false;\r\n        this._loopTotalCount = -1;\r\n        this._loopCount = 0;\r\n        this._loopComplete = null;\r\n\t\tthis._onChangeObj = null;\r\n\t\tthis._onChange = null;\r\n        this.clearTarget();\r\n\t\tthis._initialProps = {};\r\n\t\tthis._steps = null;\r\n\t\tthis._curStep = null;\r\n\t\tthis._lastStep = null;\r\n\t\tthis._isStart = false;\r\n        this._tweenId = 0;\r\n\t}\r\n\r\n    private clearTarget(){\r\n        this._target = null\r\n\t    this._targetPos = null\r\n\t    this._targetTransform = null\r\n\t    this._targetScale = null\r\n        console.log(\"清空_targetScale\")\r\n\t    this._targetRotation = null\r\n\t    this._isTargetSelf = false\r\n\t    this._targetName = \"\"\r\n    }\r\n\t\t\r\n    private clearTargetByKey(k){\r\n        if(k == \"x\" || k == \"y\" || k == \"z\"){\r\n            this._targetPos = null;\r\n        }\r\n        else if(k == \"scaleX\" || k == \"scaleY\" || k == \"scaleZ\"){\r\n            this._targetScale = null;\r\n            console.log(\"清空_targetScale\")\r\n        }\r\n        else if(k == \"rotationX\" || k == \"rotationY\" || k == \"rotationZ\"){\r\n            this._targetRotation = null;\r\n        }\r\n        else if(k == \"width\" || k == \"height\"){\r\n            this._targetTransform = null;\r\n        }\r\n    }\r\n}\r\n\r\nexport default class TweenManager {\r\n    public static TweenPool:GTween[] = [];\r\n    private static getTween():GTween {\r\n        let tw:GTween;\r\n        let time:number = game.totalTime;\r\n        for(let i = 0; i < TweenManager.TweenPool.length; i ++){\r\n            let pool:GTween = TweenManager.TweenPool[i];\r\n            if(time - pool.resetTime > 0.034){\r\n                tw = TweenManager.TweenPool.shift();\r\n                break;\r\n            }\r\n        }\r\n        if(!tw){\r\n            tw = new GTween();\r\n        }\r\n        return tw;\r\n    }\r\n\r\n    // public static TweenList:GTween[] = [];\r\n    private static TweenAttrMap:any = {\r\n        scaleX : \"x\",\r\n        scaleY : \"y\",\r\n        scaleZ : \"z\",\r\n        rotationX : \"x\",\r\n        rotationY : \"y\",\r\n        rotationZ : \"z\",\r\n        width : \"width\",\r\n        height : \"height\",\r\n    }\r\n    private static TweenId:number = 0;\r\n    private static TweenCount:number = 0;\r\n    private static TweenList = {}\r\n    private static TweenTargets = {}\r\n    public static addTween(target:any,props?:any):GTween {\r\n        if(!target) return;\r\n\r\n        let tw:GTween = TweenManager.getTween();\r\n        let tweenId:number = TweenManager.TweenId + 1;\r\n        tw.setTarget(target,tweenId);\r\n        tw.setProps(props);\r\n        TweenManager.TweenId = tweenId;\r\n        // if(!target.gtween_count) {\r\n        //     target.gtween_count = 0;\r\n        // }\r\n        // target.gtween_count++;\r\n        // TweenManager.TweenList.push(tw);\r\n        TweenManager.TweenList[tweenId] = tw;\r\n        TweenManager.TweenTargets[tweenId] = target;\r\n        TweenManager.TweenCount ++;\r\n        // console.log(\"当前缓动数量：\",TweenManager.TweenList.length,\"缓动池数量：\",TweenManager.TweenPool.length);\r\n        return tw;\r\n    }\r\n\r\n    public static removeTweens(target:any):void {\r\n        if(!target){\r\n            return;\r\n        }\r\n        // if(!target.gtween_count || target.gtween_count == 0) return;\r\n        for(let tweenId in TweenManager.TweenTargets){\r\n            let id:number = Number(tweenId);\r\n            let t = TweenManager.TweenTargets[id];\r\n            if(t == target){\r\n                TweenManager.RemoveTweenById(id);\r\n            }\r\n        }\r\n        // let tws:GTween[] = TweenManager.TweenList;\r\n        // for(let i:number = tws.length - 1; i >= 0; i--) {\r\n        //     if(tws[i].getTarget() == target) {\r\n        //         tws[i].reset();\r\n        //         tws.splice(i,1);\r\n        //     }\r\n        // }\r\n        // target.gtween_count = 0;\r\n    }\r\n\r\n    public static RemoveTweenById(tweenId:number){\r\n        if(!tweenId || tweenId == 0){\r\n            return;\r\n        }\r\n        let tw:GTween = TweenManager.TweenList[tweenId];\r\n        if(!tw){\r\n            return;\r\n        }\r\n        tw.reset();\r\n        TweenManager.TweenList[tweenId] = null;\r\n        TweenManager.TweenTargets[tweenId] = null;\r\n        TweenManager.TweenCount --;\r\n        tw.resetTime = game.totalTime;\r\n        TweenManager.TweenPool.push(tw);\r\n    }\r\n\r\n\t// \tpublic.RemoveTween = function(tweenId)\r\n    //     if not tweenId or tweenId == 0 then\r\n    //         return \r\n    //     end\r\n    //     local tw = private.TweenList[tweenId]\r\n    //     if not tw then\r\n    //         return\r\n    //     end\r\n    //     tw:Reset()\r\n    //     private.TweenList[tweenId] = nil\r\n    //     private.TweenTargets[tweenId] = nil\r\n    //     private.tweenCount = private.tweenCount - 1\r\n    //     tw.resetTime = Time.time\r\n    //     table.insert(private.TweenPool,tw)\r\n    // end\r\n\r\n    public static GetTweenAttrName(attrName:string){\r\n        return TweenManager.TweenAttrMap[attrName];\r\n    }\r\n}"]}