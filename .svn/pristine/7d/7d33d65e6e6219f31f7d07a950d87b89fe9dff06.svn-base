{"version":3,"sources":["file:///G:/Work/cocoscreator/MiniGame/assets/script/manager/EventManager.ts"],"names":["EventManager","addListener","name","listener","listenerObj","events","isExist","push","removeListener","arr","i","len","length","splice","oneEvents","d","dispatch","params","event","hasOwnProperty","apply","clear"],"mappings":"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","sourcesContent":["/**\r\n * 事件管理\r\n */\r\nexport class EventManager {\r\n\tprivate static events: any = {};\r\n\r\n\t/**\r\n     * 添加消息监听\r\n     * @param name 消息唯一标识\r\n     * @param listener 侦听函数\r\n     * @param listenerObj 侦听函数所属对象\r\n     *\r\n     */\r\n\tpublic static addListener(name: any, listener: Function, listenerObj: any): void {\r\n\t\tif (!name) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.events[name] == null) {\r\n\t\t\tthis.events[name] = [];\r\n\t\t}\r\n\r\n\t\tif (!this.isExist(name, listener, listenerObj)) {\r\n\t\t\tthis.events[name].push({ \"listener\": listener, \"listenerObj\": listenerObj });\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n     * 移除消息监听\r\n     * @param name 消息唯一标识\r\n     * @param listener 侦听函数\r\n     * @param listenerObj 侦听函数所属对象\r\n     */\r\n\tpublic static removeListener(name: any, listener: Function, listenerObj: any): void {\r\n\t\tif (!name) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet arr: Array<any> = this.events[name];\r\n\t\tif (arr == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet i: number = 0;\r\n\t\tlet len: number = arr.length;\r\n\t\tfor (i; i < len; i++) {\r\n\t\t\tif (arr[i][\"listener\"] == listener && arr[i][\"listenerObj\"] == listenerObj) {\r\n\t\t\t\tarr.splice(i, 1);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (arr.length == 0) {\r\n\t\t\tthis.events[name] = null;\r\n\t\t\tdelete this.events[name];\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 消息是否存在\r\n\t */\r\n\tpublic static isExist(name: any, listener: Function, listenerObj: any): boolean {\r\n\t\tlet isExist: boolean = false;\r\n\t\tlet oneEvents: Array<any> = this.events[name];\r\n\t\tif (oneEvents != null) {\r\n\t\t\tfor (let d of oneEvents) {\r\n\t\t\t\tif (d['listener'] == listener && d['listenerObj'] == listenerObj) {\r\n\t\t\t\t\tisExist = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn isExist;\r\n\t}\r\n\r\n\t/**\r\n\t * 分派事件\r\n\t */\r\n\tpublic static dispatch(name: any, ...params: any[]): void {\r\n\t\tif (!name) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet oneEvents: Array<any> = this.events[name];\r\n\t\tif (oneEvents != null) {\r\n\t\t\tlet event: any;\r\n\t\t\tfor (let i: number = oneEvents.length - 1; i >= 0; i--) {\r\n\t\t\t\tevent = oneEvents[i];\r\n\t\t\t\tif (event != null && event.hasOwnProperty(\"listener\")) {\r\n\t\t\t\t\tevent['listener'].apply(event['listenerObj'], params);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static clear(): void {\r\n\t\tthis.events = {};\r\n\t}\r\n}"]}