{"version":3,"sources":["file:///G:/Work/cocoscreator/MiniGame/assets/script/game/gameShulte/view/GameShulteStartView.ts"],"names":["_decorator","Component","Label","GameShulteBeginView","ccclass","property","GameShulteStartView","_beginNode","_gameStartNode","_gameContainer","_itemNodes","_ctrl","_resultNode","_txtTime","_txtResultTime","_indexList","_curType","_num","_time","_deltaTime","_isOver","_curClickIdx","_clickRight","update","deltaTime","start","getComponent","node","getChildByName","getChildByPath","GameUI","FindChild","Node","_errorAnim","engine","Animation","self","btnExit","UIButton","onClick","add","gameExit","btnAgain","playAgain","onUpdate","dt","showTime","Math","floor","text","onDestroy","active","updatePosition","clearItemGrid","gameOver","onItemClick","clickIdx","play","WrapMode","Once","stopLast","Mgr","soundMgr","updateGrid","curType","width","sizeX","curSize","i","push","itemNode","getItemGrid","addChild","transform2D","sizeY","ItemGird","setIndex","btnCom","clear","showList","randomIdx","length","random","showIdx","splice","col","row","x","y","position","GameShulteStart","ITEM_POOL","pop","prefabAsset","loader","getAsset","instantiate","console","log","startGame","type","url","load","promise","then"],"mappings":"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","sourcesContent":["import { _decorator, Component, Label, Node } from 'cc';\r\nimport { GameShulteBeginView } from './GameShulteBeginView';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('GameShulteStartView')\r\nexport class GameShulteStartView extends Component {\r\n    \r\n    private static ITEM_POOL:Node[] = [];\r\n    private _beginNode:Node;\r\n    private _gameStartNode:Node;\r\n    private _gameContainer:Node;\r\n    private _itemNodes:Node[] = [];\r\n\r\n    private _ctrl:GameShulteBeginView;\r\n    // private _ap:AudioPlayer;\r\n    private _resultNode:Node;\r\n    private _txtTime:Label;\r\n    private _txtResultTime:Label;\r\n    // private _errorAnim:engine.Animation;\r\n    \r\n    private _indexList:number[] = [];\r\n    private _curType:number;\r\n    private _num:number;\r\n    private _time:number = 0;\r\n    private _deltaTime:number = 0;\r\n    private _isOver:boolean = true;\r\n    private _curClickIdx:number = 0;\r\n    update(deltaTime: number) {\r\n        \r\n    }\r\n\r\n    public start(){\r\n        this._ctrl = this.getComponent(GameShulteBeginView);\r\n\r\n        this._beginNode = this.node.getChildByName(\"begin\");\r\n        this._gameStartNode = this.node.getChildByName(\"gameStart\");\r\n        this._gameContainer = this._gameStartNode.getChildByPath(\"group/gridGroup\");\r\n        // this._ap = Main.FindChild(this.Node,\"Sound\",AudioPlayer);\r\n        this._resultNode = this._gameStartNode.getChildByName(\"result\");\r\n        this._txtTime = GameUI.FindChild(this.Node,\"GameStart/txtTime\",Label);\r\n        this._txtResultTime = GameUI.FindChild(this._resultNode,\"txtResultTime\",Label);\r\n\r\n        this._errorAnim = GameUI.FindChild(this.Node,\"GameStart/imgError\",engine.Animation);\r\n\r\n        let self = this;\r\n        let btnExit:engine.UIButton = GameUI.FindChild(this.Node,\"GameStart/btnExit\",engine.UIButton);\r\n        btnExit.onClick.add(function(){\r\n            //退出游戏\r\n            self.gameExit();\r\n        });\r\n\r\n        let btnAgain:engine.UIButton = GameUI.FindChild(this._resultNode,\"btnAgain\",engine.UIButton);\r\n        btnAgain.onClick.add(function(){\r\n            //再来一次\r\n            self.playAgain();\r\n        });\r\n\r\n    }\r\n    public onUpdate(dt) {\r\n        if (this._isOver) return;\r\n        this._deltaTime += dt;//Time.deltaTime;\r\n        if (this._deltaTime >= 0.1){\r\n            this._time += this._deltaTime;\r\n            let showTime = Math.floor(this._time * 1000) / 1000;\r\n            this._txtTime.text = showTime + \"S\";\r\n            this._deltaTime = 0;\r\n        }\r\n    }\r\n    public onDestroy() {\r\n\r\n    }\r\n\r\n    private playAgain(){\r\n        this._resultNode.active = false;\r\n        this._isOver = false;\r\n        this.updatePosition();\r\n    }\r\n\r\n    private gameExit(){\r\n        this._curClickIdx = 0;\r\n        this._isOver = true;\r\n        this._indexList = [];\r\n        this.clearItemGrid();\r\n        this._txtTime.text = \"\";\r\n        this._deltaTime = 0;\r\n        this._time = 0;\r\n        this._resultNode.active = false;\r\n        this._gameStartNode.active = false;\r\n        this._beginNode.active = true;\r\n        this._ctrl.gameExit();\r\n    }\r\n\r\n    private gameOver(){\r\n        this._curClickIdx = 0;\r\n        this._isOver = true;\r\n        this._resultNode.active = true;\r\n        this._time = Math.floor(this._time * 1000) / 1000;\r\n        this._txtResultTime.text = \"您的成绩是：\" + this._time + \"秒\";\r\n        this._txtTime.text = \"\";\r\n        this._deltaTime = 0;\r\n        this._time = 0;\r\n    }\r\n\r\n    private _clickRight:boolean;\r\n    private onItemClick(clickIdx:number){\r\n        if(this._curClickIdx != clickIdx){\r\n            this._errorAnim.play(\"ClickError\",0,engine.Animation.WrapMode.Once);//Play(\"ClickError\", -1, 0);\r\n            // this._curClickIdx = 0;//点错一次是否重置点击\r\n            let stopLast:boolean = true;\r\n            if(this._clickRight){\r\n                //上次点击如果是正确的，音效不要中断播放\r\n                stopLast = false;\r\n            }\r\n            Mgr.soundMgr.play(\"error1\", stopLast);\r\n            this._clickRight = false;\r\n        }\r\n        else{\r\n            //right\r\n            this._curClickIdx ++;\r\n            this._itemNodes[clickIdx].active = false;\r\n            if(this._curClickIdx >= this._num){\r\n                this.gameOver();\r\n                Mgr.soundMgr.play(\"win\");\r\n            }else{\r\n                let stopLast:boolean = true;\r\n                if (!this._clickRight)\r\n                {\r\n                    //上次点击如果是错误的，音效不要中断播放\r\n                    stopLast = false;\r\n                }\r\n                Mgr.soundMgr.play(\"button1\", stopLast);\r\n            }\r\n            this._clickRight = true;\r\n        }\r\n    }\r\n\r\n    private updateGrid(){\r\n        this._isOver = false;\r\n        let curType = this._curType;\r\n        // let offset = this._systemInfo.screenWidth / 1080;\r\n        let width = this._gameContainer.sizeX;\r\n        let curSize = Math.floor(width / curType);// * offset;\r\n        \r\n        let self = this;\r\n        for (let i = 0; i < this._num; i++) {\r\n            this._indexList.push(i);\r\n            let itemNode:Node = this.getItemGrid();\r\n            itemNode.active = true;\r\n            this._gameContainer.addChild(itemNode.transform2D);\r\n            itemNode.transform2D.sizeX = curSize;\r\n            itemNode.transform2D.sizeY = curSize;\r\n\r\n            (itemNode.getComponent(ItemGird) as ItemGird).setIndex(i);\r\n            this._itemNodes.push(itemNode);\r\n\r\n            let btnCom:engine.UIButton = itemNode.getComponent(engine.UIButton);\r\n            btnCom.onClick.clear();\r\n            btnCom.onClick.add(function(){\r\n                self.onItemClick(i);\r\n            })\r\n        }\r\n        this.updatePosition();\r\n    }\r\n\r\n    private updatePosition(){\r\n        let curType = this._curType;\r\n        let width = this._gameContainer.sizeX;\r\n        let curSize = Math.floor(width / curType);\r\n        let showList:number[] = [];\r\n        for (let i = 0; i < this._num; i++) {\r\n            let itemNode:Node = this._itemNodes[i];\r\n            if(!itemNode.active){\r\n                itemNode.active = true;\r\n            }\r\n            let randomIdx:number = Math.floor(this._indexList.length * Math.random());\r\n            let showIdx:number = this._indexList.splice(randomIdx,1)[0];\r\n            showList.push(showIdx);\r\n\r\n            let col = showIdx % curType;\r\n            let row = Math.floor(showIdx / curType);\r\n            let x = col * curSize;\r\n            let y = row * - curSize;\r\n            itemNode.transform2D.position.x = x;\r\n            itemNode.transform2D.position.y = y;\r\n        }\r\n        this._indexList = showList;\r\n    }\r\n\r\n    private getItemGrid():Node{\r\n        let Node:Node = GameShulteStart.ITEM_POOL.pop();\r\n        if(!Node){\r\n            let prefabAsset:engine.Prefab = engine.loader.getAsset(\"Resources/Prefabs/ItemGrid.prefab\");\r\n            if(prefabAsset){\r\n                Node = prefabAsset.instantiate();\r\n            }\r\n            else{\r\n                console.log(\"找不到资源\");\r\n            }\r\n        }\r\n        return Node;\r\n    }\r\n\r\n    private clearItemGrid(){\r\n        for (let i = 0; i < this._itemNodes.length; i++) {\r\n            let Node = this._itemNodes[i];\r\n            Node.active = false;\r\n            GameShulteStart.ITEM_POOL.push(Node);\r\n        }\r\n        this._itemNodes = [];\r\n    }\r\n\r\n    public startGame(type:number){\r\n        this._curType = type;\r\n        this._num = type * type;\r\n\r\n        let url:string = 'Resources/Prefabs/ItemGrid.prefab';\r\n        if(engine.loader.getAsset(url)){\r\n            this.updateGrid();\r\n        }else{\r\n            let self = this;\r\n            engine.loader.load(url).promise.then((prefabAsset:engine.Prefab) => {\r\n                // 将 prefab 资源实例化\r\n                console.log(\"#######加载成功\");\r\n                self.updateGrid();\r\n            })\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}