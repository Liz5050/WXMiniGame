{"version":3,"sources":["file:///G:/Work/cocoscreator/svn/MiniGame/assets/script/game/gameShulte/view/GameShulteStartView.ts"],"names":["_decorator","Button","Component","instantiate","Label","resources","UITransform","GameShulteBeginView","Mgr","ShulteGridItem","GameType","WXSDK","ccclass","property","GameShulteStartView","_beginNode","_gameStartNode","_gameContainer","_gameContainerSize","_itemNodes","_beginView","_resultNode","_txtTime","_txtResultTime","_indexList","_curType","_num","_time","_deltaTime","_isOver","_curClickIdx","_clickRight","start","getComponent","node","getChildByName","getChildByPath","contentSize","self","btnExit","on","EventType","CLICK","gameExit","btnAgain","playAgain","update","dt","showTime","Math","floor","string","active","updatePosition","clearItemGrid","gameOver","uploadResult","value","String","Date","order","KVData","key","Shulte","postMessage","type","onItemClick","clickIdx","stopLast","soundMgr","play","updateGrid","curType","width","curSize","i","push","itemNode","getItemGrid","addChild","tr","height","setIndex","targetOff","showList","randomIdx","length","random","showIdx","splice","col","row","x","y","setPosition","ITEM_POOL","pop","prefabAsset","get","console","log","Node","startGame","url","load"],"mappings":"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","sourcesContent":["import { _decorator, Button, Component, instantiate, Label, math, Node, Prefab, resources, UITransform} from 'cc';\r\nimport { GameShulteBeginView } from './GameShulteBeginView';\r\nimport Mgr from '../../../manager/Mgr';\r\nimport { ShulteGridItem } from './ShulteGridItem';\r\nimport { GameType } from '../../../enum/GameType';\r\nimport WXSDK from '../../../SDK/WXSDK';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('GameShulteStartView')\r\nexport class GameShulteStartView extends Component {\r\n    \r\n    private static ITEM_POOL:Node[] = [];\r\n    private _beginNode:Node;\r\n    private _gameStartNode:Node;\r\n    private _gameContainer:Node;\r\n    private _gameContainerSize:math.Size;\r\n    private _itemNodes:Node[] = [];\r\n\r\n    private _beginView:GameShulteBeginView;\r\n    // private _ap:AudioPlayer;\r\n    private _resultNode:Node;\r\n    private _txtTime:Label;\r\n    private _txtResultTime:Label;\r\n    // private _errorAnim:engine.Animation;\r\n    \r\n    private _indexList:number[] = [];\r\n    private _curType:number;\r\n    private _num:number;\r\n    private _time:number = 0;\r\n    private _deltaTime:number = 0;\r\n    private _isOver:boolean = true;\r\n    private _curClickIdx:number = 0;\r\n    public start(){\r\n        this._beginView = this.getComponent(GameShulteBeginView);\r\n        \r\n        this._beginNode = this.node.getChildByName(\"begin\");\r\n        this._gameStartNode = this.node.getChildByName(\"gameStart\");\r\n        this._gameContainer = this._gameStartNode.getChildByPath(\"group/gridGroup\");\r\n        this._gameContainerSize = this._gameContainer.getComponent(UITransform).contentSize;\r\n        // this._ap = Main.FindChild(this.Node,\"Sound\",AudioPlayer);\r\n        this._resultNode = this._gameStartNode.getChildByName(\"result\");\r\n        this._txtTime = this._gameStartNode.getChildByName(\"txtTime\").getComponent(Label);\r\n        this._txtResultTime = this._resultNode.getChildByName(\"txtResultTime\").getComponent(Label);\r\n\r\n        // this._errorAnim = GameUI.FindChild(this.Node,\"GameStart/imgError\",engine.Animation);\r\n\r\n        let self = this;\r\n        let btnExit:Node = this._gameStartNode.getChildByName(\"btnBack\");\r\n        btnExit.on(Button.EventType.CLICK,function(){\r\n            //退出游戏\r\n            self.gameExit();\r\n        });\r\n        let btnAgain:Node = this._resultNode.getChildByName(\"btnAgain\");\r\n        btnAgain.on(Button.EventType.CLICK,function(){\r\n            //再来一次\r\n            self.playAgain();\r\n        });\r\n\r\n    }\r\n    public update(dt:number) {\r\n        if (this._isOver) return;\r\n        this._deltaTime += dt;//Time.deltaTime;\r\n        if (this._deltaTime >= 0.1){\r\n            this._time += this._deltaTime;\r\n            let showTime = Math.floor(this._time * 1000) / 1000;\r\n            this._txtTime.string = showTime + \"S\";\r\n            this._deltaTime = 0;\r\n        }\r\n    }\r\n\r\n    private playAgain(){\r\n        this._resultNode.active = false;\r\n        this._isOver = false;\r\n        this.updatePosition();\r\n    }\r\n\r\n    private gameExit(){\r\n        this._curClickIdx = 0;\r\n        this._isOver = true;\r\n        this._indexList = [];\r\n        this.clearItemGrid();\r\n        this._txtTime.string = \"\";\r\n        this._deltaTime = 0;\r\n        this._time = 0;\r\n        this._resultNode.active = false;\r\n        this._gameStartNode.active = false;\r\n        this._beginNode.active = true;\r\n        this._beginView.gameExit();\r\n    }\r\n\r\n    private gameOver(){\r\n        this.uploadResult();\r\n        this._curClickIdx = 0;\r\n        this._isOver = true;\r\n        this._resultNode.active = true;\r\n        this._time = Math.floor(this._time * 1000) / 1000;\r\n        this._txtResultTime.string = \"您的成绩是：\" + this._time + \"秒\";\r\n        this._txtTime.string = \"\";\r\n        this._deltaTime = 0;\r\n        this._time = 0;\r\n    }\r\n\r\n    private uploadResult(){\r\n        let value = {\r\n            \"wxgame\": {\r\n                \"value\": this._time,\r\n                \"update_time\": String(+ new Date() / 1000)\r\n            },\r\n            \"unitStr\":\"秒\",\r\n            order:1\r\n        }\r\n        let KVData = { key: \"rank_\" + GameType.Shulte, value: value };\r\n        WXSDK.postMessage({type:\"UploadScore\",KVData:KVData});\r\n    }\r\n\r\n    private _clickRight:boolean;\r\n    private onItemClick(clickIdx:number){\r\n        if(this._curClickIdx != clickIdx){\r\n            // this._errorAnim.play(\"ClickError\",0,engine.Animation.WrapMode.Once);//Play(\"ClickError\", -1, 0);\r\n            // this._curClickIdx = 0;//点错一次是否重置点击\r\n            let stopLast:boolean = true;\r\n            if(this._clickRight){\r\n                //上次点击如果是正确的，音效不要中断播放\r\n                stopLast = false;\r\n            }\r\n            Mgr.soundMgr.play(\"error1\", stopLast);\r\n            this._clickRight = false;\r\n        }\r\n        else{\r\n            //right\r\n            this._curClickIdx ++;\r\n            this._itemNodes[clickIdx].active = false;\r\n            if(this._curClickIdx >= this._num){\r\n                this.gameOver();\r\n                Mgr.soundMgr.play(\"win\");\r\n            }else{\r\n                let stopLast:boolean = true;\r\n                if (!this._clickRight)\r\n                {\r\n                    //上次点击如果是错误的，音效不要中断播放\r\n                    stopLast = false;\r\n                }\r\n                Mgr.soundMgr.play(\"button1\", stopLast);\r\n            }\r\n            this._clickRight = true;\r\n        }\r\n    }\r\n\r\n    private updateGrid(){\r\n        this._isOver = false;\r\n        let curType = this._curType;\r\n        // let offset = this._systemInfo.screenWidth / 1080;\r\n        let width = this._gameContainerSize.width;\r\n        let curSize = Math.floor(width / curType);// * offset;\r\n        \r\n        let self = this;\r\n        for (let i = 0; i < this._num; i++) {\r\n            this._indexList.push(i);\r\n            let itemNode:Node = this.getItemGrid();\r\n            itemNode.active = true;\r\n            this._gameContainer.addChild(itemNode);\r\n            let tr = itemNode.getComponent(UITransform);\r\n            tr.width = curSize;\r\n            tr.height = curSize;\r\n\r\n            itemNode.getComponent(ShulteGridItem).setIndex(i);\r\n            this._itemNodes.push(itemNode);\r\n\r\n            // let btnCom:engine.UIButton = itemNode.getComponent(engine.UIButton);\r\n            itemNode.targetOff(Button.EventType.CLICK);\r\n            itemNode.on(Button.EventType.CLICK,function(){\r\n                self.onItemClick(i);\r\n            });\r\n        }\r\n        this.updatePosition();\r\n    }\r\n\r\n    private updatePosition(){\r\n        let curType = this._curType;\r\n        let width = this._gameContainerSize.width;\r\n        let curSize = Math.floor(width / curType);\r\n        let showList:number[] = [];\r\n        for (let i = 0; i < this._num; i++) {\r\n            let itemNode:Node = this._itemNodes[i];\r\n            if(!itemNode.active){\r\n                itemNode.active = true;\r\n            }\r\n            let randomIdx:number = Math.floor(this._indexList.length * Math.random());\r\n            let showIdx:number = this._indexList.splice(randomIdx,1)[0];\r\n            showList.push(showIdx);\r\n\r\n            let col = showIdx % curType;\r\n            let row = Math.floor(showIdx / curType);\r\n            let x = col * curSize;\r\n            let y = row * - curSize;\r\n            itemNode.setPosition(x,y);\r\n        }\r\n        this._indexList = showList;\r\n    }\r\n\r\n    private getItemGrid():Node{\r\n        let node:Node = GameShulteStartView.ITEM_POOL.pop();\r\n        if(!node){\r\n            let prefabAsset:Prefab = resources.get(\"prefab/ShulteGridItem\");\r\n            if(prefabAsset){\r\n                node = instantiate(prefabAsset);\r\n            }\r\n            else{\r\n                console.log(\"找不到资源\");\r\n            }\r\n        }\r\n        return node;\r\n    }\r\n\r\n    private clearItemGrid(){\r\n        for (let i = 0; i < this._itemNodes.length; i++) {\r\n            let Node = this._itemNodes[i];\r\n            Node.active = false;\r\n            GameShulteStartView.ITEM_POOL.push(Node);\r\n        }\r\n        this._itemNodes = [];\r\n    }\r\n\r\n    public startGame(type:number){\r\n        this._curType = type;\r\n        this._num = type * type;\r\n\r\n        let url:string = 'prefab/ShulteGridItem';\r\n        if(resources.get(url)){\r\n            this.updateGrid();\r\n        }else{\r\n            let self = this;\r\n            resources.load(url,function(){\r\n                self.updateGrid();\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}