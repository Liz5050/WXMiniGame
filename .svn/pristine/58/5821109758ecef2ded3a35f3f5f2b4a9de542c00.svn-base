{"version":3,"sources":["file:///G:/Work/cocoscreator/MiniGame/assets/script/common/TweenManager.ts"],"names":["GTween","TweenManager","UITransform","error","game","constructor","_target","_targetName","_targetTransform","_targetPos","_targetScale","_targetRotation","_isTargetSelf","_targetProps","_steps","_initialProps","_stepProps","_isStart","_stepTime","_curStep","_lastStep","_loop","_loopCount","_loopTotalCount","_loopComplete","_stepIdx","_onChange","_onChangeObj","_tweenId","resetTime","timeIndex","setProps","props","loopTotalCount","loop","onChange","onChangeObj","setTarget","t","tweenId","console","log","Object","getPrototypeOf","prototype","toString","call","getTarget","to","duration","ease","key","getTargetAttr","clearTargetByKey","addStep","type","callback","thisObj","params","callBack","wait","time","step","push","beginTween","getStep","length","apply","stopAction","setTargetAttr","shift","totalTime","runAction","self","setInterval","curTime","ratio","Math","min","keyName","undefined","diff","value","stepProps","checkTargetAttr","k","errorTips","getComponent","getPosition","getScale","getRotation","curStepStr","getStepTestStr","stepStr","i","targetName","v","setPosition","GetTweenAttrName","setScale","setRotation","RemoveTweenById","reset","clearInterval","clearTarget","getTween","tw","TweenPool","pool","addTween","target","TweenId","TweenList","TweenTargets","TweenCount","removeTweens","id","Number","attrName","TweenAttrMap","scaleX","scaleY","scaleZ","rotationX","rotationY","rotationZ","width","height"],"mappings":"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","sourcesContent":["import { Director, UITransform, _decorator, director, error, game, math } from \"cc\";\r\n\r\n/**\r\n * 对象池管理缓动\r\n * @author Liz 2019年4月18日21:10:57\r\n */\r\nclass GTween {\r\n\tprivate _target:any;\r\n    private _targetName:string;\r\n    private _targetTransform:UITransform;\r\n    private _targetPos:math.Vec3;\r\n    private _targetScale:math.Vec3;\r\n    private _targetRotation:math.Vec3;\r\n    private _isTargetSelf:boolean;\r\n    private _targetProps:any;\r\n\r\n\tprivate _steps:any[];\r\n\tprivate _initialProps:any;\r\n\tprivate _stepProps:any;\r\n\tprivate _isStart:boolean = false;\r\n\tprivate _stepTime:number;\r\n\tprivate _curStep:any;\r\n\tprivate _lastStep:any;\r\n\r\n\tprivate _loop:boolean = false;\r\n    private _loopCount:number = 0;\r\n    private _loopTotalCount:number = 0;\r\n    private _loopComplete:Function;\r\n\tprivate _stepIdx:number = 0;\r\n\tprivate _onChange:Function;\r\n\tprivate _onChangeObj:any;\r\n    private _tweenId:number = 0;\r\n    public resetTime:number = 0;\r\n\tpublic constructor() {\r\n\t}\r\n\r\n\tpublic setProps(props:any):void {\r\n\t\tif(!props) return;\r\n        this._loopTotalCount = props.loopTotalCount;\r\n        if(props.loop || (this._loopTotalCount && this._loopTotalCount > 0)){\r\n            this._loop = true;\r\n        }\r\n\t\tthis._onChange = props.onChange;\r\n\t\tthis._onChangeObj = props.onChangeObj;\r\n        this._loopComplete = props._loopComplete;\r\n\t}\r\n\r\n\tpublic setTarget(t:any,tweenId:number) {\r\n\t\tthis._target = t;\r\n        this._tweenId = tweenId;\r\n\t\tthis._initialProps = null;\r\n        console.log(\"添加缓动1\" + typeof(t));\r\n        console.log(\"添加缓动3\" + Object.getPrototypeOf(t));\r\n        console.log(\"添加缓动3\" + Object.prototype.toString.call(t));\r\n\t}\r\n\r\n    public get tweenId():number {\r\n        return this._tweenId;\r\n    }\r\n\r\n\tpublic getTarget():any {\r\n\t\treturn this._target;\r\n\t}\r\n\r\n\tpublic to(props:any,duration?:number,ease?: Function):GTween {\r\n\t\tif(!this._target) return;\r\n\t\tif(!props || typeof(props) != \"object\") return;\r\n\t\tif(!duration || duration < 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n        if(!this._initialProps){\r\n            this._initialProps = {}\r\n            for(let key in props) {\r\n                this._initialProps[key] = this.getTargetAttr(key);\r\n                this.clearTargetByKey(key);\r\n            }\r\n        }\r\n\t\tthis.addStep({\r\n\t\t\ttype:\"to\",\r\n\t\t\tprops:props,\r\n\t\t\tduration:duration,\r\n\t\t\tease:ease});\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic call(callback: Function, thisObj?: any, params?: any[]):GTween {\r\n\t\tthis.addStep({\r\n\t\t\ttype : \"call\",\r\n\t\t\tcallBack : callback,\r\n\t\t\tthisObj : thisObj,\r\n\t\t\tparams : params});\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic wait(time:number):GTween {\r\n\t\tthis.addStep({\r\n\t\t\ttype : \"wait\",\r\n\t\t\tduration : time});\r\n\t\treturn this;\r\n\t}\r\n\r\n\tprivate addStep(step:any):void {\r\n\t\tif(!this._steps) {\r\n\t\t\tthis._steps = [];\r\n\t\t}\r\n\t\tthis._steps.push(step);\r\n\t\tthis.beginTween();\r\n\t}\r\n\t\r\n\tprivate beginTween():void {\r\n\t\tif(this._isStart) return;\r\n\t\tthis._isStart = true;\r\n\t\tthis.getStep();\r\n\t}\r\n\r\n\tprivate getStep():void {\r\n\t\tif(!this._isStart) return;\r\n\t\tif(this._loop) {\r\n\t\t\tif(this._stepIdx >= this._steps.length) {\r\n                this._loopCount ++;\r\n                if(this._loopTotalCount && this._loopTotalCount > 0 && this._loopCount >= this._loopTotalCount){\r\n                    //loopComplete\r\n                    if(this._loopComplete){\r\n                        this._loopComplete.apply(this._curStep.thisObj);\r\n                        // this._loopComplete.call();\r\n                    }\r\n                    this.stopAction();\r\n                    return\r\n                }\r\n\t\t\t\tthis._stepIdx = 0;\r\n                if(this._initialProps){\r\n                    for(let key in this._initialProps) {\r\n                        this.setTargetAttr(key,this._initialProps[key]);\r\n                        // this._target[key] = this._initialProps[key];\r\n                    }\r\n                }\r\n                //一轮循环结束，属性已经重设到初始值，不用校正\r\n                this._lastStep = null;\r\n\t\t\t}\r\n\t\t\tthis._curStep = this._steps[this._stepIdx];\r\n\t\t\tthis._stepIdx ++;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis._curStep = this._steps.shift();\r\n\t\t}\r\n\t\t//属性校正\r\n\t\tif(this._lastStep && this._lastStep.props) {\r\n\t\t\tfor(let key in this._lastStep.props) {\r\n\t\t\t\tthis._target[key] = this._lastStep.props[key];\r\n                this.setTargetAttr(key,this._lastStep.props[key]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._lastStep = this._curStep;\r\n\t\tif(!this._curStep) {\r\n\t\t\tthis.stopAction();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(this._curStep.type == \"call\") {\r\n\t\t\tthis._curStep.callBack.apply(this._curStep.thisObj,this._curStep.params);\r\n\t\t\tthis.getStep();\r\n\t\t\treturn;\r\n        }\r\n\t\tthis._stepTime = game.totalTime + this._curStep.duration;\r\n\t\tthis._stepProps = {};\r\n\t\tthis.runAction();\r\n\t}\r\n\r\n\tprivate timeIndex:number = -1;\r\n\tprivate runAction():void {\r\n\t\tif(this.timeIndex == -1) {\r\n            let self = this;\r\n\t\t\tthis.timeIndex = setInterval(function(){\r\n\t\t\t\tlet curTime:number = game.totalTime;\r\n\t\t\t\tif(curTime >= self._stepTime){\r\n\t\t\t\t\tself.getStep();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif(self._curStep.type == \"to\") {\r\n\t\t\t\t\tlet props:any = self._curStep.props;\r\n\t\t\t\t\tlet ratio:number = (self._curStep.duration - (self._stepTime - curTime)) / self._curStep.duration;\r\n\t\t\t\t\tratio = Math.min(ratio,1);\r\n\t\t\t\t\tif(self._curStep.ease) {\r\n\t\t\t\t\t\tratio = self._curStep.ease(ratio,0,1,1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(let keyName in props) {\r\n\t\t\t\t\t\tif(self._stepProps[keyName] == undefined) {\r\n\t\t\t\t\t\t\tself._stepProps[keyName] = this.getTargetAttr(keyName);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlet diff:number = props[keyName] - self._stepProps[keyName];\r\n                        let value = this.stepProps[keyName] + (diff * ratio);\r\n                        self._targetProps[keyName] = value;\r\n                        self.setTargetAttr(keyName,value);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(self._onChange && self._onChangeObj) {\r\n\t\t\t\t\tself._onChange.apply(self._onChangeObj,self._targetProps);\r\n\t\t\t\t}\r\n\t\t\t},1);\r\n\t\t}\r\n\t}\r\n\r\n    private checkTargetAttr(k){\r\n        let errorTips = \"\";\r\n        \r\n        if (typeof(this._target) == \"object\"){\r\n            if(this._target[k]){\r\n                this._isTargetSelf = true\r\n            }\r\n            else{\r\n                errorTips = \"not found \" + k + \" in tween target.\";\r\n            }\r\n        }else{\r\n            if(this._target == null){\r\n                errorTips = \"tween target is null\";\r\n            }\r\n            else{\r\n                if(!this._targetTransform){\r\n                    this._targetTransform = this._target.getComponent(UITransform);\r\n                }\r\n                if(!this._targetTransform){\r\n                    errorTips = \"not found transform in tween target. ----key：\" + k;\r\n                }\r\n            }\r\n        }\r\n\r\n        if(errorTips == \"\"){\r\n            if(k == \"x\" || k == \"y\" || k == \"z\"){\r\n                if(!this._targetPos){\r\n                    this._targetPos = this._target.getPosition();\r\n                }\r\n            }\r\n            else if(k == \"scaleX\" || k == \"scaleY\" || k == \"scaleZ\"){\r\n                if(!this._targetScale){\r\n                    this._targetScale = this._target.getScale();\r\n                }\r\n            }\r\n            else if(k == \"rotationX\" || k == \"rotationY\" || k == \"rotationZ\"){\r\n                if(!this._targetRotation){\r\n                    this._targetRotation = this._target.getRotation();\r\n                }\r\n            }\r\n            else if(k == \"width\" || k == \"height\"){\r\n               \r\n            }\r\n            else if(!this._target[k]){\r\n                errorTips = \"not found \" + k + \" in tween target.\";\r\n            }\r\n        }\r\n        if(errorTips != \"\"){\r\n            let curStepStr:string = this.getStepTestStr(this._curStep);\r\n            let stepStr:string = \"\";\r\n            if(this._steps){\r\n                for(let i:number = 0; i < this._steps.length; i ++){\r\n                    stepStr = stepStr + \"(step\" + i + \")\" + this.getStepTestStr(this._steps[i]);\r\n                }\r\n            }\r\n            let targetName = this._targetName;\r\n            // TweenUtil.RemoveTween(self.tweenId)\r\n            error(errorTips + \"--->>>targetName：\" + targetName + \"，curStep：\" + curStepStr + \"，stepList：\" + stepStr);\r\n        }\r\n    }\r\n\r\n    private getStepTestStr(step:any):string{\r\n        let stepStr:string = \"\";\r\n        if(step){\r\n            stepStr = step.type\r\n            if(step.props){\r\n                for (let key in step.props) {\r\n                    let v = step.props[key];\r\n                    stepStr = stepStr + \"-->\" + key + \"=\" + v + \",\";\r\n                }\r\n            }\r\n            if(step.duration){\r\n                stepStr = stepStr + \"time：\" + step.duration;\r\n            }\r\n        }\r\n        return stepStr;\r\n    }\r\n\r\n    private setTargetAttr(k,v){\r\n        this.checkTargetAttr(k);\r\n        if(this._isTargetSelf){\r\n            this._target[k] = v;\r\n            return;\r\n        }\r\n        if(k == \"x\" || k == \"y\" || k == \"z\"){\r\n            this._targetPos[k] = v;\r\n            this._target.setPosition(this._targetPos);\r\n        }\r\n        else if(k == \"scaleX\" || k == \"scaleY\" || k == \"scaleZ\"){\r\n            this._targetScale[TweenManager.GetTweenAttrName(k)] = v;\r\n            this._target.setScale(this._targetScale);\r\n        }\r\n        else if(k == \"rotationX\" || k == \"rotationY\" || k == \"rotationZ\"){\r\n            this._targetRotation[TweenManager.GetTweenAttrName(k)] = v;\r\n            this._target.setRotation(this._targetRotation);\r\n        }\r\n        else if(k == \"width\" || k == \"height\"){\r\n            this._targetTransform[k] = v;\r\n        }\r\n        else if(this._target[k]){\r\n            this._target[k] = v;\r\n        }\r\n    }\r\n\r\n    private getTargetAttr(k){\r\n        this.checkTargetAttr(k);\r\n        if(this._isTargetSelf){\r\n            return this._target[k];\r\n        }\r\n        if(k == \"x\" || k == \"y\" || k == \"z\"){\r\n            return this._targetPos[k];\r\n        }\r\n        else if(k == \"scaleX\" || k == \"scaleY\" || k == \"scaleZ\"){\r\n            return this._targetScale[TweenManager.GetTweenAttrName(k)];\r\n        }\r\n        else if(k == \"rotationX\" || k == \"rotationY\" || k == \"rotationZ\"){\r\n            return this._targetRotation[TweenManager.GetTweenAttrName(k)];\r\n        }\r\n        else{\r\n            return this._target[k];\r\n        }\r\n    }\r\n\r\n\tprivate stopAction():void {\r\n        // if not self.isStart or self.tweenId == 0 then return end\r\n\t\t//     TweenUtil.RemoveTween(self.tweenId)\r\n\t\tif(!this._isStart || this._tweenId == 0) return;\r\n\t\tTweenManager.RemoveTweenById(this._tweenId);\r\n\t}\r\n\r\n\tpublic reset():void {\r\n\t\tif(!this._isStart) return;\r\n\t\tif(this.timeIndex != -1) {\r\n            clearInterval(this.timeIndex);\r\n\t\t\tthis.timeIndex = -1;\r\n\t\t}\r\n\t\tthis._stepIdx = 0;\r\n\t\tthis._loop = false;\r\n        this._loopTotalCount = -1;\r\n        this._loopCount = 0;\r\n        this._loopComplete = null;\r\n\t\tthis._onChangeObj = null;\r\n\t\tthis._onChange = null;\r\n        this.clearTarget();\r\n\t\tthis._initialProps = {};\r\n\t\tthis._steps = null;\r\n\t\tthis._curStep = null;\r\n\t\tthis._lastStep = null;\r\n\t\tthis._isStart = false;\r\n        this._tweenId = 0;\r\n\t}\r\n\r\n    // function public:Reset()\r\n\t// \t    private.canUpdate = false\r\n\t\t    \r\n\t// \t    private.stepIdx = 1\r\n\t// \t    private.loop = false\r\n\t// \t    private.loopTotalCount = -1\r\n\t// \t    private.loopCount = 0\r\n\t// \t    private.onChange = nil\r\n\t// \t    private.loopComplete = nil\r\n\t// \t    private:ClearTarget()\r\n\t// \t    private.steps = nil\r\n\t// \t    private.curStepStr = nil\r\n\t// \t    private.lastStep = nil\r\n\t// \t    private.initialProps = nil\r\n\t// \t    private.isStart = false\r\n\t// \t    private.tweenId = 0\r\n\t// \t    private.timeCount = 0\r\n\t// \tend\r\n\r\n    private clearTarget(){\r\n        this._target = null\r\n\t    this._targetPos = null\r\n\t    this._targetTransform = null\r\n\t    this._targetScale = null\r\n\t    this._targetRotation = null\r\n\t    this._isTargetSelf = false\r\n\t    this._targetName = \"\"\r\n    }\r\n\t\t\r\n    private clearTargetByKey(k){\r\n        if(k == \"x\" || k == \"y\" || k == \"z\"){\r\n            this._targetPos = null;\r\n        }\r\n        else if(k == \"scaleX\" || k == \"scaleY\" || k == \"scaleZ\"){\r\n            this._targetScale = null;\r\n        }\r\n        else if(k == \"rotationX\" || k == \"rotationY\" || k == \"rotationZ\"){\r\n            this._targetRotation = null;\r\n        }\r\n        else if(k == \"width\" || k == \"height\"){\r\n            this._targetTransform = null;\r\n        }\r\n    }\r\n}\r\n\r\nexport default class TweenManager {\r\n    public static TweenPool:GTween[] = [];\r\n    private static getTween():GTween {\r\n        let tw:GTween;\r\n        let time:number = game.totalTime;\r\n        for(let i = 0; i < TweenManager.TweenPool.length; i ++){\r\n            let pool:GTween = TweenManager.TweenPool[i];\r\n            if(time - pool.resetTime > 0.034){\r\n                tw = TweenManager.TweenPool.shift();\r\n                break;\r\n            }\r\n        }\r\n        if(!tw){\r\n            tw = new GTween();\r\n        }\r\n        return tw;\r\n    }\r\n\r\n    // public static TweenList:GTween[] = [];\r\n    private static TweenAttrMap:any = {\r\n        scaleX : \"x\",\r\n        scaleY : \"y\",\r\n        scaleZ : \"z\",\r\n        rotationX : \"x\",\r\n        rotationY : \"y\",\r\n        rotationZ : \"z\",\r\n        width : \"width\",\r\n        height : \"height\",\r\n    }\r\n    private static TweenId:number = 0;\r\n    private static TweenCount:number = 0;\r\n    private static TweenList = {}\r\n    private static TweenTargets = {}\r\n    public static addTween(target:any,props?:any):GTween {\r\n        if(!target) return;\r\n\r\n        let tw:GTween = TweenManager.getTween();\r\n        let tweenId:number = TweenManager.TweenId + 1;\r\n        tw.setTarget(target,tweenId);\r\n        tw.setProps(props);\r\n        TweenManager.TweenId = tweenId;\r\n        // if(!target.gtween_count) {\r\n        //     target.gtween_count = 0;\r\n        // }\r\n        // target.gtween_count++;\r\n        // TweenManager.TweenList.push(tw);\r\n        TweenManager.TweenList[tweenId] = tw;\r\n        TweenManager.TweenTargets[tweenId] = target;\r\n        TweenManager.TweenCount ++;\r\n        // console.log(\"当前缓动数量：\",TweenManager.TweenList.length,\"缓动池数量：\",TweenManager.TweenPool.length);\r\n        return tw;\r\n    }\r\n\r\n    public static removeTweens(target:any):void {\r\n        if(!target){\r\n            return;\r\n        }\r\n        // if(!target.gtween_count || target.gtween_count == 0) return;\r\n        for(let tweenId in TweenManager.TweenTargets){\r\n            let id:number = Number(tweenId);\r\n            let t = TweenManager.TweenTargets[id];\r\n            if(t == target){\r\n                TweenManager.RemoveTweenById(id);\r\n            }\r\n        }\r\n        // let tws:GTween[] = TweenManager.TweenList;\r\n        // for(let i:number = tws.length - 1; i >= 0; i--) {\r\n        //     if(tws[i].getTarget() == target) {\r\n        //         tws[i].reset();\r\n        //         tws.splice(i,1);\r\n        //     }\r\n        // }\r\n        // target.gtween_count = 0;\r\n    }\r\n\r\n    public static RemoveTweenById(tweenId:number){\r\n        if(!tweenId || tweenId == 0){\r\n            return;\r\n        }\r\n        let tw:GTween = TweenManager.TweenList[tweenId];\r\n        if(!tw){\r\n            return;\r\n        }\r\n        tw.reset();\r\n        TweenManager.TweenList[tweenId] = null;\r\n        TweenManager.TweenTargets[tweenId] = null;\r\n        TweenManager.TweenCount --;\r\n        tw.resetTime = game.totalTime;\r\n        TweenManager.TweenPool.push(tw);\r\n    }\r\n\r\n\t// \tpublic.RemoveTween = function(tweenId)\r\n    //     if not tweenId or tweenId == 0 then\r\n    //         return \r\n    //     end\r\n    //     local tw = private.TweenList[tweenId]\r\n    //     if not tw then\r\n    //         return\r\n    //     end\r\n    //     tw:Reset()\r\n    //     private.TweenList[tweenId] = nil\r\n    //     private.TweenTargets[tweenId] = nil\r\n    //     private.tweenCount = private.tweenCount - 1\r\n    //     tw.resetTime = Time.time\r\n    //     table.insert(private.TweenPool,tw)\r\n    // end\r\n\r\n    public static GetTweenAttrName(attrName:string){\r\n        return TweenManager.TweenAttrMap[attrName] || attrName;\r\n    }\r\n}"]}