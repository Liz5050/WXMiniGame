{"version":3,"sources":["file:///G:/Work/cocoscreator/svn/MiniGame/assets/script/game/MainMenu.ts"],"names":["_decorator","Button","Component","Toggle","EventManager","EventEnum","GameType","GameState","Mgr","WXSDK","ccclass","property","MainMenu","_gameState","update","deltaTime","start","addListener","OnGameExit","self","muteToggle","node","getChildByName","getComponent","soundNormal","on","EventType","TOGGLE","active","isChecked","soundMgr","setMute","btnShulte","CLICK","OnStartGame","Shulte","btnGridGame","Grid","play","btnNullify","clickCount","targetNum","showTips","Math","round","random","Nullify","showToast","openDatacontext","btnRank","postMessage","type","width","height","x","y","btnClose","btnTest","sceneMgr","LoadScene","SetGameState","Home","Playing","dispatch","OnGameStart","state"],"mappings":"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","sourcesContent":["import { _decorator, Button, Component, director, Node, NodeEventType, SubContextView, Toggle } from 'cc';\r\nimport { EventManager } from '../manager/EventManager';\r\nimport { EventEnum } from '../enum/EventEnum';\r\nimport { GameType } from '../enum/GameType';\r\nimport { GameState } from '../enum/GameState';\r\nimport Mgr from '../manager/Mgr';\r\nimport WXSDK from '../SDK/WXSDK';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('MainMenu')\r\nexport class MainMenu extends Component {\r\n    private _gameState:GameState;\r\n    update(deltaTime: number) {\r\n        \r\n    }\r\n\r\n    public start(){\r\n        EventManager.addListener(EventEnum.OnGameExit,this.OnGameExit,this);\r\n\r\n        let self = this;\r\n        let muteToggle:Toggle = this.node.getChildByName(\"muteToggle\").getComponent(Toggle);\r\n        let soundNormal:Node = muteToggle.node.getChildByName(\"normal\");\r\n        muteToggle.node.on(Toggle.EventType.TOGGLE,function(){\r\n            soundNormal.active = !muteToggle.isChecked;\r\n            Mgr.soundMgr.setMute(muteToggle.isChecked);\r\n        });\r\n\r\n        let btnShulte = this.node.getChildByName(\"btnShulte\");\r\n        btnShulte.on(Button.EventType.CLICK,function(){\r\n            self.OnStartGame(GameType.Shulte);\r\n        });\r\n        let btnGridGame = this.node.getChildByName(\"btnGrid\");\r\n        btnGridGame.on(Button.EventType.CLICK,function(){\r\n            self.OnStartGame(GameType.Grid);\r\n            Mgr.soundMgr.play(\"game_start\");\r\n        });\r\n\r\n        let btnNullify = this.node.getChildByName(\"btnNullify\");\r\n        let clickCount = 0;\r\n        let targetNum = -1;\r\n        btnNullify.on(Button.EventType.CLICK,function(){\r\n            // self.OnStartGame(GameType.Nullify);\r\n            let showTips:string = \"你别急，已经在开发中了~\";\r\n            clickCount++;\r\n            if(targetNum == -1){\r\n                targetNum = 1 + Math.round(Math.random()*10);\r\n            }\r\n            if(clickCount >= targetNum){\r\n                showTips = \"跟你说了别急，你还点什么点？\";\r\n            }\r\n            else if(clickCount >= targetNum + 10){\r\n                showTips = \"这么期待？给你看一眼？\";\r\n            }\r\n            else if(clickCount >= targetNum + 11){\r\n                self.OnStartGame(GameType.Nullify);\r\n            }\r\n            else if(clickCount >= targetNum + 12){\r\n                showTips = \"你别急，已经在开发中了~\";\r\n            }\r\n            else if(clickCount >= targetNum + 20){\r\n                showTips = \"有话想对我说？vme50（vx：lizhi5050）\";\r\n            }\r\n            WXSDK.showToast(showTips);\r\n        });\r\n        let openDatacontext = this.node.getChildByName(\"openDataContext\");\r\n        let btnRank = this.node.getChildByName(\"btnRank\");\r\n        btnRank.on(Button.EventType.CLICK,function(){\r\n            openDatacontext.active = true;\r\n            WXSDK.postMessage({type:\"ShowRank\",width:1080,height:1800,x:540,y:1080});\r\n            // wx.showToast({\r\n            //     title: `暂无排名`,\r\n            //     icon: 'none',\r\n            //     duration: 2000\r\n            // });\r\n        });\r\n\r\n        let btnClose = openDatacontext.getChildByName(\"btnClose\");\r\n        btnClose.on(Button.EventType.CLICK,function(){\r\n            openDatacontext.active = false;\r\n        });\r\n\r\n        let btnTest = this.node.getChildByName(\"btnTest\");\r\n        btnTest.on(Button.EventType.CLICK,function(){\r\n            Mgr.sceneMgr.LoadScene(\"sceneTest\");\r\n        });\r\n\r\n        \r\n        this.SetGameState(GameState.Home);\r\n    }\r\n\r\n    private OnStartGame(type:GameType){\r\n        if(this._gameState == GameState.Playing){\r\n            return;\r\n        }\r\n        this.SetGameState(GameState.Playing);\r\n        EventManager.dispatch(EventEnum.OnGameStart,type);\r\n    }\r\n\r\n    private OnGameExit(){\r\n        this.SetGameState(GameState.Home);\r\n    }\r\n\r\n    private SetGameState(state:GameState){\r\n        if(state == GameState.Home){\r\n            this.node.active = true;\r\n        }\r\n        else if(state == GameState.Playing){\r\n            this.node.active = false;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n"]}