{"version":3,"sources":["file:///G:/Work/cocoscreator/MiniGame/assets/script/game/gameShulte/view/GameShulteStartView.ts"],"names":["_decorator","Component","ccclass","property","GameShulteStartView","_beginEntity","_gameStartEntity","_gameContainer","_itemEntitys","_ctrl","_resultEntity","_txtTime","_txtResultTime","_errorAnim","_indexList","_curType","_num","_time","_deltaTime","_isOver","_curClickIdx","_clickRight","onAwake","entity","getComponent","GameShulteBegin","update","deltaTime","start","GameUI","FindChild","transform2D","engine","UILabel","Animation","self","btnExit","UIButton","onClick","add","gameExit","btnAgain","playAgain","onUpdate","dt","showTime","Math","floor","text","onDestroy","active","updatePosition","clearItemGrid","gameOver","onItemClick","clickIdx","play","WrapMode","Once","stopLast","Mgr","soundMgr","updateGrid","curType","width","sizeX","curSize","push","i","itemEntity","getItemGrid","addChild","sizeY","ItemGird","setIndex","btnCom","clear","showList","randomIdx","length","random","showIdx","splice","col","row","x","y","position","GameShulteStart","ITEM_POOL","pop","prefabAsset","loader","getAsset","instantiate","console","log","startGame","type","url","load","promise","then"],"mappings":";;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;;;;;;;;;OACf;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBH,U;;qCAGjBI,mB,WADZF,OAAO,CAAC,qBAAD,C,2BAAR,MACaE,mBADb,SACyCH,SADzC,CACmD;AAAA;AAAA;AAAA,eAGvCI,YAHuC;AAAA,eAIvCC,gBAJuC;AAAA,eAKvCC,cALuC;AAAA,eAMvCC,YANuC,GAMR,EANQ;AAAA,eAQvCC,KARuC;AAS/C;AAT+C,eAUvCC,aAVuC;AAAA,eAWvCC,QAXuC;AAAA,eAYvCC,cAZuC;AAAA,eAavCC,UAbuC;AAAA,eAevCC,UAfuC,GAejB,EAfiB;AAAA,eAgBvCC,QAhBuC;AAAA,eAiBvCC,IAjBuC;AAAA,eAkBvCC,KAlBuC,GAkBxB,CAlBwB;AAAA,eAmBvCC,UAnBuC,GAmBnB,CAnBmB;AAAA,eAoBvCC,OApBuC,GAoBrB,IApBqB;AAAA,eAqBvCC,YArBuC,GAqBjB,CArBiB;AAAA,eAoGvCC,WApGuC;AAAA;;AAsBxCC,QAAAA,OAAO,GAAG;AACb,eAAKb,KAAL,GAAa,KAAKc,MAAL,CAAYC,YAAZ,CAAyBC,eAAzB,CAAb;AACH;;AAEDC,QAAAA,MAAM,CAACC,SAAD,EAAoB,CAEzB;;AAEMC,QAAAA,KAAK,GAAE;AACV,eAAKvB,YAAL,GAAoBwB,MAAM,CAACC,SAAP,CAAiB,KAAKP,MAAtB,EAA6B,OAA7B,CAApB;AACA,eAAKjB,gBAAL,GAAwBuB,MAAM,CAACC,SAAP,CAAiB,KAAKP,MAAtB,EAA6B,WAA7B,CAAxB;AACA,eAAKhB,cAAL,GAAsBsB,MAAM,CAACC,SAAP,CAAiB,KAAKP,MAAtB,EAA6B,2BAA7B,EAA0DQ,WAAhF,CAHU,CAIV;;AACA,eAAKrB,aAAL,GAAqBmB,MAAM,CAACC,SAAP,CAAiB,KAAKP,MAAtB,EAA6B,kBAA7B,CAArB;AACA,eAAKZ,QAAL,GAAgBkB,MAAM,CAACC,SAAP,CAAiB,KAAKP,MAAtB,EAA6B,mBAA7B,EAAiDS,MAAM,CAACC,OAAxD,CAAhB;AACA,eAAKrB,cAAL,GAAsBiB,MAAM,CAACC,SAAP,CAAiB,KAAKpB,aAAtB,EAAoC,eAApC,EAAoDsB,MAAM,CAACC,OAA3D,CAAtB;AAEA,eAAKpB,UAAL,GAAkBgB,MAAM,CAACC,SAAP,CAAiB,KAAKP,MAAtB,EAA6B,oBAA7B,EAAkDS,MAAM,CAACE,SAAzD,CAAlB;AAEA,cAAIC,IAAI,GAAG,IAAX;AACA,cAAIC,OAAuB,GAAGP,MAAM,CAACC,SAAP,CAAiB,KAAKP,MAAtB,EAA6B,mBAA7B,EAAiDS,MAAM,CAACK,QAAxD,CAA9B;AACAD,UAAAA,OAAO,CAACE,OAAR,CAAgBC,GAAhB,CAAoB,YAAU;AAC1B;AACAJ,YAAAA,IAAI,CAACK,QAAL;AACH,WAHD;AAKA,cAAIC,QAAwB,GAAGZ,MAAM,CAACC,SAAP,CAAiB,KAAKpB,aAAtB,EAAoC,UAApC,EAA+CsB,MAAM,CAACK,QAAtD,CAA/B;AACAI,UAAAA,QAAQ,CAACH,OAAT,CAAiBC,GAAjB,CAAqB,YAAU;AAC3B;AACAJ,YAAAA,IAAI,CAACO,SAAL;AACH,WAHD;AAKH;;AACMC,QAAAA,QAAQ,CAACC,EAAD,EAAK;AAChB,cAAI,KAAKzB,OAAT,EAAkB;AAClB,eAAKD,UAAL,IAAmB0B,EAAnB,CAFgB,CAEM;;AACtB,cAAI,KAAK1B,UAAL,IAAmB,GAAvB,EAA2B;AACvB,iBAAKD,KAAL,IAAc,KAAKC,UAAnB;AACA,gBAAI2B,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAW,KAAK9B,KAAL,GAAa,IAAxB,IAAgC,IAA/C;AACA,iBAAKN,QAAL,CAAcqC,IAAd,GAAqBH,QAAQ,GAAG,GAAhC;AACA,iBAAK3B,UAAL,GAAkB,CAAlB;AACH;AACJ;;AACM+B,QAAAA,SAAS,GAAG,CAElB;;AAEOP,QAAAA,SAAS,GAAE;AACf,eAAKhC,aAAL,CAAmBwC,MAAnB,GAA4B,KAA5B;AACA,eAAK/B,OAAL,GAAe,KAAf;AACA,eAAKgC,cAAL;AACH;;AAEOX,QAAAA,QAAQ,GAAE;AACd,eAAKpB,YAAL,GAAoB,CAApB;AACA,eAAKD,OAAL,GAAe,IAAf;AACA,eAAKL,UAAL,GAAkB,EAAlB;AACA,eAAKsC,aAAL;AACA,eAAKzC,QAAL,CAAcqC,IAAd,GAAqB,EAArB;AACA,eAAK9B,UAAL,GAAkB,CAAlB;AACA,eAAKD,KAAL,GAAa,CAAb;AACA,eAAKP,aAAL,CAAmBwC,MAAnB,GAA4B,KAA5B;AACA,eAAK5C,gBAAL,CAAsB4C,MAAtB,GAA+B,KAA/B;AACA,eAAK7C,YAAL,CAAkB6C,MAAlB,GAA2B,IAA3B;;AACA,eAAKzC,KAAL,CAAW+B,QAAX;AACH;;AAEOa,QAAAA,QAAQ,GAAE;AACd,eAAKjC,YAAL,GAAoB,CAApB;AACA,eAAKD,OAAL,GAAe,IAAf;AACA,eAAKT,aAAL,CAAmBwC,MAAnB,GAA4B,IAA5B;AACA,eAAKjC,KAAL,GAAa6B,IAAI,CAACC,KAAL,CAAW,KAAK9B,KAAL,GAAa,IAAxB,IAAgC,IAA7C;AACA,eAAKL,cAAL,CAAoBoC,IAApB,GAA2B,WAAW,KAAK/B,KAAhB,GAAwB,GAAnD;AACA,eAAKN,QAAL,CAAcqC,IAAd,GAAqB,EAArB;AACA,eAAK9B,UAAL,GAAkB,CAAlB;AACA,eAAKD,KAAL,GAAa,CAAb;AACH;;AAGOqC,QAAAA,WAAW,CAACC,QAAD,EAAiB;AAChC,cAAG,KAAKnC,YAAL,IAAqBmC,QAAxB,EAAiC;AAC7B,iBAAK1C,UAAL,CAAgB2C,IAAhB,CAAqB,YAArB,EAAkC,CAAlC,EAAoCxB,MAAM,CAACE,SAAP,CAAiBuB,QAAjB,CAA0BC,IAA9D,EAD6B,CACuC;AACpE;;;AACA,gBAAIC,QAAgB,GAAG,IAAvB;;AACA,gBAAG,KAAKtC,WAAR,EAAoB;AAChB;AACAsC,cAAAA,QAAQ,GAAG,KAAX;AACH;;AACDC,YAAAA,GAAG,CAACC,QAAJ,CAAaL,IAAb,CAAkB,QAAlB,EAA4BG,QAA5B;AACA,iBAAKtC,WAAL,GAAmB,KAAnB;AACH,WAVD,MAWI;AACA;AACA,iBAAKD,YAAL;AACA,iBAAKZ,YAAL,CAAkB+C,QAAlB,EAA4BL,MAA5B,GAAqC,KAArC;;AACA,gBAAG,KAAK9B,YAAL,IAAqB,KAAKJ,IAA7B,EAAkC;AAC9B,mBAAKqC,QAAL;AACAO,cAAAA,GAAG,CAACC,QAAJ,CAAaL,IAAb,CAAkB,KAAlB;AACH,aAHD,MAGK;AACD,kBAAIG,SAAgB,GAAG,IAAvB;;AACA,kBAAI,CAAC,KAAKtC,WAAV,EACA;AACI;AACAsC,gBAAAA,SAAQ,GAAG,KAAX;AACH;;AACDC,cAAAA,GAAG,CAACC,QAAJ,CAAaL,IAAb,CAAkB,SAAlB,EAA6BG,SAA7B;AACH;;AACD,iBAAKtC,WAAL,GAAmB,IAAnB;AACH;AACJ;;AAEOyC,QAAAA,UAAU,GAAE;AAAA;;AAChB,eAAK3C,OAAL,GAAe,KAAf;AACA,cAAI4C,OAAO,GAAG,KAAKhD,QAAnB,CAFgB,CAGhB;;AACA,cAAIiD,KAAK,GAAG,KAAKzD,cAAL,CAAoB0D,KAAhC;AACA,cAAIC,OAAO,GAAGpB,IAAI,CAACC,KAAL,CAAWiB,KAAK,GAAGD,OAAnB,CAAd,CALgB,CAK0B;;AAE1C,cAAI5B,IAAI,GAAG,IAAX;;AAPgB,wCAQoB;AAChC,YAAA,KAAI,CAACrB,UAAL,CAAgBqD,IAAhB,CAAqBC,CAArB;;AACA,gBAAIC,UAAwB,GAAG,KAAI,CAACC,WAAL,EAA/B;;AACAD,YAAAA,UAAU,CAACnB,MAAX,GAAoB,IAApB;;AACA,YAAA,KAAI,CAAC3C,cAAL,CAAoBgE,QAApB,CAA6BF,UAAU,CAACtC,WAAxC;;AACAsC,YAAAA,UAAU,CAACtC,WAAX,CAAuBkC,KAAvB,GAA+BC,OAA/B;AACAG,YAAAA,UAAU,CAACtC,WAAX,CAAuByC,KAAvB,GAA+BN,OAA/B;AAECG,YAAAA,UAAU,CAAC7C,YAAX,CAAwBiD,QAAxB,CAAD,CAAgDC,QAAhD,CAAyDN,CAAzD;;AACA,YAAA,KAAI,CAAC5D,YAAL,CAAkB2D,IAAlB,CAAuBE,UAAvB;;AAEA,gBAAIM,MAAsB,GAAGN,UAAU,CAAC7C,YAAX,CAAwBQ,MAAM,CAACK,QAA/B,CAA7B;AACAsC,YAAAA,MAAM,CAACrC,OAAP,CAAesC,KAAf;AACAD,YAAAA,MAAM,CAACrC,OAAP,CAAeC,GAAf,CAAmB,YAAU;AACzBJ,cAAAA,IAAI,CAACmB,WAAL,CAAiBc,CAAjB;AACH,aAFD;AAGH,WAxBe;;AAQhB,eAAK,IAAIA,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKpD,IAAzB,EAA+BoD,CAAC,EAAhC;AAAA;AAAA;;AAiBA,eAAKjB,cAAL;AACH;;AAEOA,QAAAA,cAAc,GAAE;AACpB,cAAIY,OAAO,GAAG,KAAKhD,QAAnB;AACA,cAAIiD,KAAK,GAAG,KAAKzD,cAAL,CAAoB0D,KAAhC;AACA,cAAIC,OAAO,GAAGpB,IAAI,CAACC,KAAL,CAAWiB,KAAK,GAAGD,OAAnB,CAAd;AACA,cAAIc,QAAiB,GAAG,EAAxB;;AACA,eAAK,IAAIT,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKpD,IAAzB,EAA+BoD,CAAC,EAAhC,EAAoC;AAChC,gBAAIC,UAAwB,GAAG,KAAK7D,YAAL,CAAkB4D,CAAlB,CAA/B;;AACA,gBAAG,CAACC,UAAU,CAACnB,MAAf,EAAsB;AAClBmB,cAAAA,UAAU,CAACnB,MAAX,GAAoB,IAApB;AACH;;AACD,gBAAI4B,SAAgB,GAAGhC,IAAI,CAACC,KAAL,CAAW,KAAKjC,UAAL,CAAgBiE,MAAhB,GAAyBjC,IAAI,CAACkC,MAAL,EAApC,CAAvB;;AACA,gBAAIC,OAAc,GAAG,KAAKnE,UAAL,CAAgBoE,MAAhB,CAAuBJ,SAAvB,EAAiC,CAAjC,EAAoC,CAApC,CAArB;;AACAD,YAAAA,QAAQ,CAACV,IAAT,CAAcc,OAAd;AAEA,gBAAIE,GAAG,GAAGF,OAAO,GAAGlB,OAApB;AACA,gBAAIqB,GAAG,GAAGtC,IAAI,CAACC,KAAL,CAAWkC,OAAO,GAAGlB,OAArB,CAAV;AACA,gBAAIsB,CAAC,GAAGF,GAAG,GAAGjB,OAAd;AACA,gBAAIoB,CAAC,GAAGF,GAAG,GAAG,CAAElB,OAAhB;AACAG,YAAAA,UAAU,CAACtC,WAAX,CAAuBwD,QAAvB,CAAgCF,CAAhC,GAAoCA,CAApC;AACAhB,YAAAA,UAAU,CAACtC,WAAX,CAAuBwD,QAAvB,CAAgCD,CAAhC,GAAoCA,CAApC;AACH;;AACD,eAAKxE,UAAL,GAAkB+D,QAAlB;AACH;;AAEOP,QAAAA,WAAW,GAAgB;AAC/B,cAAI/C,MAAoB,GAAGiE,eAAe,CAACC,SAAhB,CAA0BC,GAA1B,EAA3B;;AACA,cAAG,CAACnE,MAAJ,EAAW;AACP,gBAAIoE,WAAyB,GAAG3D,MAAM,CAAC4D,MAAP,CAAcC,QAAd,CAAuB,mCAAvB,CAAhC;;AACA,gBAAGF,WAAH,EAAe;AACXpE,cAAAA,MAAM,GAAGoE,WAAW,CAACG,WAAZ,EAAT;AACH,aAFD,MAGI;AACAC,cAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ;AACH;AACJ;;AACD,iBAAOzE,MAAP;AACH;;AAEO6B,QAAAA,aAAa,GAAE;AACnB,eAAK,IAAIgB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK5D,YAAL,CAAkBuE,MAAtC,EAA8CX,CAAC,EAA/C,EAAmD;AAC/C,gBAAI7C,MAAM,GAAG,KAAKf,YAAL,CAAkB4D,CAAlB,CAAb;AACA7C,YAAAA,MAAM,CAAC2B,MAAP,GAAgB,KAAhB;AACAsC,YAAAA,eAAe,CAACC,SAAhB,CAA0BtB,IAA1B,CAA+B5C,MAA/B;AACH;;AACD,eAAKf,YAAL,GAAoB,EAApB;AACH;;AAEMyF,QAAAA,SAAS,CAACC,IAAD,EAAa;AACzB,eAAKnF,QAAL,GAAgBmF,IAAhB;AACA,eAAKlF,IAAL,GAAYkF,IAAI,GAAGA,IAAnB;AAEA,cAAIC,GAAU,GAAG,mCAAjB;;AACA,cAAGnE,MAAM,CAAC4D,MAAP,CAAcC,QAAd,CAAuBM,GAAvB,CAAH,EAA+B;AAC3B,iBAAKrC,UAAL;AACH,WAFD,MAEK;AACD,gBAAI3B,IAAI,GAAG,IAAX;AACAH,YAAAA,MAAM,CAAC4D,MAAP,CAAcQ,IAAd,CAAmBD,GAAnB,EAAwBE,OAAxB,CAAgCC,IAAhC,CAAsCX,WAAD,IAA+B;AAChE;AACAI,cAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACA7D,cAAAA,IAAI,CAAC2B,UAAL;AACH,aAJD;AAKH;AACJ;;AA/N8C,O,UAEhC2B,S,GAA4B,E","sourcesContent":["import { _decorator, Component, Node } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('GameShulteStartView')\r\nexport class GameShulteStartView extends Component {\r\n    \r\n    private static ITEM_POOL:engine.Entity[] = [];\r\n    private _beginEntity:engine.Entity;\r\n    private _gameStartEntity:engine.Entity;\r\n    private _gameContainer:engine.Transform2D;\r\n    private _itemEntitys:engine.Entity[] = [];\r\n\r\n    private _ctrl:GameShulteBegin;\r\n    // private _ap:AudioPlayer;\r\n    private _resultEntity:engine.Entity;\r\n    private _txtTime:engine.UILabel;\r\n    private _txtResultTime:engine.UILabel;\r\n    private _errorAnim:engine.Animation;\r\n    \r\n    private _indexList:number[] = [];\r\n    private _curType:number;\r\n    private _num:number;\r\n    private _time:number = 0;\r\n    private _deltaTime:number = 0;\r\n    private _isOver:boolean = true;\r\n    private _curClickIdx:number = 0;\r\n    public onAwake() {\r\n        this._ctrl = this.entity.getComponent(GameShulteBegin);\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        \r\n    }\r\n    \r\n    public start(){\r\n        this._beginEntity = GameUI.FindChild(this.entity,\"Begin\");\r\n        this._gameStartEntity = GameUI.FindChild(this.entity,\"GameStart\");\r\n        this._gameContainer = GameUI.FindChild(this.entity,\"GameStart/Group/GridGroup\").transform2D;\r\n        // this._ap = Main.FindChild(this.entity,\"Sound\",AudioPlayer);\r\n        this._resultEntity = GameUI.FindChild(this.entity,\"GameStart/Result\");\r\n        this._txtTime = GameUI.FindChild(this.entity,\"GameStart/txtTime\",engine.UILabel);\r\n        this._txtResultTime = GameUI.FindChild(this._resultEntity,\"txtResultTime\",engine.UILabel);\r\n\r\n        this._errorAnim = GameUI.FindChild(this.entity,\"GameStart/imgError\",engine.Animation);\r\n\r\n        let self = this;\r\n        let btnExit:engine.UIButton = GameUI.FindChild(this.entity,\"GameStart/btnExit\",engine.UIButton);\r\n        btnExit.onClick.add(function(){\r\n            //退出游戏\r\n            self.gameExit();\r\n        });\r\n\r\n        let btnAgain:engine.UIButton = GameUI.FindChild(this._resultEntity,\"btnAgain\",engine.UIButton);\r\n        btnAgain.onClick.add(function(){\r\n            //再来一次\r\n            self.playAgain();\r\n        });\r\n\r\n    }\r\n    public onUpdate(dt) {\r\n        if (this._isOver) return;\r\n        this._deltaTime += dt;//Time.deltaTime;\r\n        if (this._deltaTime >= 0.1){\r\n            this._time += this._deltaTime;\r\n            let showTime = Math.floor(this._time * 1000) / 1000;\r\n            this._txtTime.text = showTime + \"S\";\r\n            this._deltaTime = 0;\r\n        }\r\n    }\r\n    public onDestroy() {\r\n\r\n    }\r\n\r\n    private playAgain(){\r\n        this._resultEntity.active = false;\r\n        this._isOver = false;\r\n        this.updatePosition();\r\n    }\r\n\r\n    private gameExit(){\r\n        this._curClickIdx = 0;\r\n        this._isOver = true;\r\n        this._indexList = [];\r\n        this.clearItemGrid();\r\n        this._txtTime.text = \"\";\r\n        this._deltaTime = 0;\r\n        this._time = 0;\r\n        this._resultEntity.active = false;\r\n        this._gameStartEntity.active = false;\r\n        this._beginEntity.active = true;\r\n        this._ctrl.gameExit();\r\n    }\r\n\r\n    private gameOver(){\r\n        this._curClickIdx = 0;\r\n        this._isOver = true;\r\n        this._resultEntity.active = true;\r\n        this._time = Math.floor(this._time * 1000) / 1000;\r\n        this._txtResultTime.text = \"您的成绩是：\" + this._time + \"秒\";\r\n        this._txtTime.text = \"\";\r\n        this._deltaTime = 0;\r\n        this._time = 0;\r\n    }\r\n\r\n    private _clickRight:boolean;\r\n    private onItemClick(clickIdx:number){\r\n        if(this._curClickIdx != clickIdx){\r\n            this._errorAnim.play(\"ClickError\",0,engine.Animation.WrapMode.Once);//Play(\"ClickError\", -1, 0);\r\n            // this._curClickIdx = 0;//点错一次是否重置点击\r\n            let stopLast:boolean = true;\r\n            if(this._clickRight){\r\n                //上次点击如果是正确的，音效不要中断播放\r\n                stopLast = false;\r\n            }\r\n            Mgr.soundMgr.play(\"error1\", stopLast);\r\n            this._clickRight = false;\r\n        }\r\n        else{\r\n            //right\r\n            this._curClickIdx ++;\r\n            this._itemEntitys[clickIdx].active = false;\r\n            if(this._curClickIdx >= this._num){\r\n                this.gameOver();\r\n                Mgr.soundMgr.play(\"win\");\r\n            }else{\r\n                let stopLast:boolean = true;\r\n                if (!this._clickRight)\r\n                {\r\n                    //上次点击如果是错误的，音效不要中断播放\r\n                    stopLast = false;\r\n                }\r\n                Mgr.soundMgr.play(\"button1\", stopLast);\r\n            }\r\n            this._clickRight = true;\r\n        }\r\n    }\r\n\r\n    private updateGrid(){\r\n        this._isOver = false;\r\n        let curType = this._curType;\r\n        // let offset = this._systemInfo.screenWidth / 1080;\r\n        let width = this._gameContainer.sizeX;\r\n        let curSize = Math.floor(width / curType);// * offset;\r\n        \r\n        let self = this;\r\n        for (let i = 0; i < this._num; i++) {\r\n            this._indexList.push(i);\r\n            let itemEntity:engine.Entity = this.getItemGrid();\r\n            itemEntity.active = true;\r\n            this._gameContainer.addChild(itemEntity.transform2D);\r\n            itemEntity.transform2D.sizeX = curSize;\r\n            itemEntity.transform2D.sizeY = curSize;\r\n\r\n            (itemEntity.getComponent(ItemGird) as ItemGird).setIndex(i);\r\n            this._itemEntitys.push(itemEntity);\r\n\r\n            let btnCom:engine.UIButton = itemEntity.getComponent(engine.UIButton);\r\n            btnCom.onClick.clear();\r\n            btnCom.onClick.add(function(){\r\n                self.onItemClick(i);\r\n            })\r\n        }\r\n        this.updatePosition();\r\n    }\r\n\r\n    private updatePosition(){\r\n        let curType = this._curType;\r\n        let width = this._gameContainer.sizeX;\r\n        let curSize = Math.floor(width / curType);\r\n        let showList:number[] = [];\r\n        for (let i = 0; i < this._num; i++) {\r\n            let itemEntity:engine.Entity = this._itemEntitys[i];\r\n            if(!itemEntity.active){\r\n                itemEntity.active = true;\r\n            }\r\n            let randomIdx:number = Math.floor(this._indexList.length * Math.random());\r\n            let showIdx:number = this._indexList.splice(randomIdx,1)[0];\r\n            showList.push(showIdx);\r\n\r\n            let col = showIdx % curType;\r\n            let row = Math.floor(showIdx / curType);\r\n            let x = col * curSize;\r\n            let y = row * - curSize;\r\n            itemEntity.transform2D.position.x = x;\r\n            itemEntity.transform2D.position.y = y;\r\n        }\r\n        this._indexList = showList;\r\n    }\r\n\r\n    private getItemGrid():engine.Entity{\r\n        let entity:engine.Entity = GameShulteStart.ITEM_POOL.pop();\r\n        if(!entity){\r\n            let prefabAsset:engine.Prefab = engine.loader.getAsset(\"Resources/Prefabs/ItemGrid.prefab\");\r\n            if(prefabAsset){\r\n                entity = prefabAsset.instantiate();\r\n            }\r\n            else{\r\n                console.log(\"找不到资源\");\r\n            }\r\n        }\r\n        return entity;\r\n    }\r\n\r\n    private clearItemGrid(){\r\n        for (let i = 0; i < this._itemEntitys.length; i++) {\r\n            let entity = this._itemEntitys[i];\r\n            entity.active = false;\r\n            GameShulteStart.ITEM_POOL.push(entity);\r\n        }\r\n        this._itemEntitys = [];\r\n    }\r\n\r\n    public startGame(type:number){\r\n        this._curType = type;\r\n        this._num = type * type;\r\n\r\n        let url:string = 'Resources/Prefabs/ItemGrid.prefab';\r\n        if(engine.loader.getAsset(url)){\r\n            this.updateGrid();\r\n        }else{\r\n            let self = this;\r\n            engine.loader.load(url).promise.then((prefabAsset:engine.Prefab) => {\r\n                // 将 prefab 资源实例化\r\n                console.log(\"#######加载成功\");\r\n                self.updateGrid();\r\n            })\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}